env:
  global:
  - REPO_NAME=NJUPole/aliyun-odps-python-sdk
  - REPO_DIR=.
  - BUILD_COMMIT=v0.7.6
  - PLAT=x86_64
  - BUILD_DEP="cython"
  - UNICODE_WIDTH=32
  - secure: hoJUfS4h8dnt/vctif96zLLIW2D76gaL2wLjqi2QCRFq18W/+7TNz+cfpkGKpYBstQ2McAJ7S5N+zNvWmCSa4QhzDHN5s3SHxd12/yFfJ7xntPFltGJR0DDFEi3N6DKw/Id6NDPIgTr9mhaxtnbwo0C6qSetXTq7N1F8XBQbLBUuzos+EV5/2ZTp8p4QEWXNlZZwLKMR3I26flmHx+YM/LZokcAwjqvl1F02kBuHsXKq8zH8zclz8LqEukGPP5vhmUAbrcNNC2Ht/E9BDJ2wzNSZ1WP8uuI1CPMrwl1GJZ/SYH3oajLwMvOtz3DtTHgt7wC8ZG8r/uZg+lUGxAIEcind9UJc5RtJxKmonPN3bwppDrdhR0W6/0RkmVlAulPL/EWIlSzX6+LjhKXJzk4G2nUApaWFpx05vg85JPGVNpsNnpCaZyMI+EuLk5rUXeRSOmJAYRFd2527acdvUZuIQYT6UG4vs6DHvb4x/8Co4cPO7XFyIpWoPebFuIO7sQZj8tXaXATnC+MlG77TlS0iFUUIum9fVDuPue6W3Y/ZFtNcRAvR/BZJ05dZI7nrp4MMZgo0SV1ldvZUAS446FiGm+EgI5tSKXLvp00Y3J53X8Sz+ZKbw5bJAN8gVejIM7o4GP6AD/EIlTfIL6ESV+B0ax7S6ZoAWKd6dmN7S1+42Z0=
language: python
python: 3.5
sudo: required
dist: trusty
services: docker
matrix:
  exclude:
  - python: 3.5
  include:
  - os: linux
    env: MB_PYTHON_VERSION=2.7
  - os: linux
    env:
    - MB_PYTHON_VERSION=2.7
    - UNICODE_WIDTH=16
  - os: linux
    env:
    - MB_PYTHON_VERSION=2.7
    - PLAT=i686
  - os: linux
    env:
    - MB_PYTHON_VERSION=2.7
    - PLAT=i686
    - UNICODE_WIDTH=16
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.5
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.5
    - PLAT=i686
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.6
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.6
    - PLAT=i686
  - os: osx
    language: generic
    env:
    - MB_PYTHON_VERSION=2.7
  - os: osx
    language: generic
    env:
    - MB_PYTHON_VERSION=3.5
  - os: osx
    language: generic
    env:
    - MB_PYTHON_VERSION=3.6
before_install:
  - ls
  - BUILD_DEPENDS="$BUILD_DEP"
  - source multibuild/common_utils.sh
  - source multibuild/travis_steps.sh
  - before_install
install:
  - build_wheel $REPO_DIR $PLAT
script:
  #- test
  - ls
  - pip install twine
  - echo "[distutils]"                                  > ~/.pypirc
  - echo "index-servers ="                             >> ~/.pypirc
  - echo "    testpypi"                                >> ~/.pypirc
  - echo "[testpypi]"                                  >> ~/.pypirc
  - echo "repository:https://testpypi.python.org/pypi" >> ~/.pypirc
  - echo "username:pyodps"                             >> ~/.pypirc
  - echo password:secure:hoJUfS4h8dnt/vctif96zLLIW2D76gaL2wLjqi2QCRFq18W/+7TNz+cfpkGKpYBstQ2McAJ7S5N+zNvWmCSa4QhzDHN5s3SHxd12/yFfJ7xntPFltGJR0DDFEi3N6DKw/Id6NDPIgTr9mhaxtnbwo0C6qSetXTq7N1F8XBQbLBUuzos+EV5/2ZTp8p4QEWXNlZZwLKMR3I26flmHx+YM/LZokcAwjqvl1F02kBuHsXKq8zH8zclz8LqEukGPP5vhmUAbrcNNC2Ht/E9BDJ2wzNSZ1WP8uuI1CPMrwl1GJZ/SYH3oajLwMvOtz3DtTHgt7wC8ZG8r/uZg+lUGxAIEcind9UJc5RtJxKmonPN3bwppDrdhR0W6/0RkmVlAulPL/EWIlSzX6+LjhKXJzk4G2nUApaWFpx05vg85JPGVNpsNnpCaZyMI+EuLk5rUXeRSOmJAYRFd2527acdvUZuIQYT6UG4vs6DHvb4x/8Co4cPO7XFyIpWoPebFuIO7sQZj8tXaXATnC+MlG77TlS0iFUUIum9fVDuPue6W3Y/ZFtNcRAvR/BZJ05dZI7nrp4MMZgo0SV1ldvZUAS446FiGm+EgI5tSKXLvp00Y3J53X8Sz+ZKbw5bJAN8gVejIM7o4GP6AD/EIlTfIL6ESV+B0ax7S6ZoAWKd6dmN7S1+42Z0=  >> ~/.pypirc
  - twine upload -r testpypi --skip-existing wheelhouse/*.whl
